Create Consignment API
-----------------------------------

.. table::

   +-------------------+--------------------------------------------+
   | POST              | ``/consignments``                          |
   +-------------------+--------------------------------------------+

Data Structure
^^^^^^^^^^^^^^^^^
``dynamic`` and ``materials`` must be provided in the request.

.. table::
    :width: 100%

    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | Field Name              | Data Type                                                    | Description                                       | Value                                                                       |
    +=========================+==============================================================+===================================================+=============================================================================+
    | due_date                | string *(required)*                                          | Due date (DD.MM.YYYY)                             | "19.09.2025"                                                                |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | consignment_type        | int *(required)*                                             | Consignment type                                  | 123                                                                         |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | operator_id             | integer *(optional)*                                         | User ID                                           | 123                                                                         |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | materials               | list of dict *(required)*                                    | Material list info                                | [{"id":837,"gross_weight":7,"tare_weight":2,"planned_weight": 10}]          |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | entity_name             | string *(optional)*                                          | Name of the entity                                | "client_xyz"                                                                |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | order_name              | string *(optional)*                                          | Order name                                        | "Order-ABC-01"                                                              |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | entity_id               | string *(optional)*                                          | Entity ID                                         | "d666a904-5739-46c0-b70a-1cd57658a3f6"                                      |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | order_id                | string *(optional)*                                          | Order ID                                          | "d666a904-5739-46c0-b70a-1cd57658a3f6"                                      |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | extra_field             | dict *(optional)*                                            | Additional data                                   | {"custom_note": "urgent"}                                                   |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | name                    | string *(optional)*                                          | Name                                              | "Consignment-01"                                                            |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | status_step             | int *(optional)*                                             | Step of consignment status                        | 123                                                                         |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | transfer_client_id      | integer *(optional)*                                         | Transfer Client ID                                | 123                                                                         |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | duplicated_from         | integer *(optional)*                                         | Source Consignment ID                             | 123                                                                         |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | dynamic                 | list of dict *(required)*                                    | Dynamic fields                                    | [{"key": "foo", "value": "bar"}]                                            |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+
    | branch_id               | integer *(optional)*                                         | Branch ID                                         | 123                                                                         |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+-----------------------------------------------------------------------------+


Example Code
^^^^^^^^^^^^^^^^^

.. code-block:: python

    import requests

    EVREKA360_API_BASE_URL = ""
    ACCESS_TOKEN = ""

    service_url = "/mrf/consignments"
    headers = {
        "Content-Type": "application/json; charset=utf-8",
        "Authorization": "Bearer " + ACCESS_TOKEN
    }

    # Data Example
    data = {
        "name":"Consignment-1",
        "due_date":"19.09.2025",
        "consignment_type":9,
        "dynamic":[
            {"key":"Dynamic-1","value":"value-1"},
            {"key":"Dynamic-2","value":"value-2"}
        ],
        "entity_id":"6200c441-4a52-461f-af04-c74f11478cac",
        "entity_name":"Entity-1",
        "transfer_client_id":7,
        "materials":[
            {"id":837,"gross_weight":100,"tare_weight":20,"planned_weight":80},
            {"id":836,"gross_weight":75,"tare_weight":5,"planned_weight":70}
        ],
        "branch_id":24
    }


    resp = requests.post(EVREKA360_API_BASE_URL + service_url, headers=headers, json=data)
    print(resp.status_code, resp.json())

Response
^^^^^^^^^^^^^^^^^
*Status Code:* ``200`` - Retrieved successfully
*Content Type:* ``application/json``
*Body:*

.. code-block:: json

    {
        "consignment_id": "ID - int",
        "consignment_external_id": "External ID - UUID",
        "non_existent_dynamic_fields": "Non existing dynamic fields list - Optional[List[Dict]]"
    }


*Status Code:* ``400`` - Bad request
*Content Type:* ``application/json``
*Body:*

.. code-block:: json

    {
        "detail":"An error occurred while creating the Consignment"
    }

