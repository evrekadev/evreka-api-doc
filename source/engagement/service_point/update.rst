Update Service Point API
-----------------------------------

.. table::

   +-------------------+-----------------------------------------------+
   | POST              | ``/service_points/{service_point_id}``        |
   +-------------------+-----------------------------------------------+

Data Structure
^^^^^^^^^^^^^^^^^

All existing fields on the service point must be provided to maintain existing data.
``ops_service_point_id`` and ``ops_service_point_name`` must be provided together.

.. table::
    :width: 100%

    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | Field Name              | Data Type                                                    | Description                                       | Value                                                                              |
    +=========================+==============================================================+===================================================+====================================================================================+
    | name                    | string *(optional)*                                          | Name                                              | "updated_service_point"                                                            |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | type                    | string *(optional)*                                          | Type ID - UUID                                    | "d666a904-5739-46c0-b70a-1cd57658a3f6"                                             |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | status                  | string *(optional)*                                          | Status ID - UUID                                  | "e5e41ad2-1c46-4c3b-91cb-4cf1a82ac120"                                             |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | contact_list            | list object *(optional)*                                     | List of Contact IDs - UUID                        | ``["abf8c97a-9a43-4232-a8ff-5d6a4d87c021"]``                                       |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | latitude                | float *(optional)*                                           | Latitude                                          | 30.54321                                                                           |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | longitude               | float *(optional)*                                           | Longitude                                         | -12.5432                                                                           |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | dynamic_field_list      | list object *(required)*                                     | Object contains dynamic field key and value       | ``[{"key":"numberField","value": 456}]``                                           |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | order_settings          | list object *(required)*                                     | Object contains order type id and order items.    | ``[{"order_type":"07b31501-70f9-4d4c-8eb7-3b013ebe8d62",                           |
    |                         |                                                              |                                                   | "order_items":["573806b5-f054-48a2-8043-c75a83be871e"]}]``                         | 
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | entities                | list object *(optional)*                                     | List of Entity ID - UUID                          | ``["009f40a6-1dd5-4380-97b5-8b0d406ee45a"]``                                       |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | ops_service_point_id    | integer *(optional)*                                         | Service Point ID in Ops Management                | 12345                                                                              |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | ops_service_point_name  | string *(optional)*                                          | Service Point Name in Ops Management              | "ops_service_point_updated"                                                        |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | attachments             | File *(optional)*                                            | Service Point Attachments (new uploads)           | ``my_attachment.png``                                                              |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | attachments_tbd         | list object *(optional)*                                     | List of existing attachment names to be deleted   | ``["009f40a6-1dd5-4380-97b5-8b0d406ee45a"]``                                       |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+
    | address                 | string *(optional)*                                          | Address                                           | "123 Example St, Example City"                                                     |
    +-------------------------+--------------------------------------------------------------+---------------------------------------------------+------------------------------------------------------------------------------------+


Example Code
^^^^^^^^^^^^^^^^^

.. code-block:: python

    import requests
    import json

    EVREKA360_API_BASE_URL = ""
    ACCESS_TOKEN = ""

    service_point_id = "<SERVICE_POINT_ID>"
    service_url = f"/engagement/service_points/{service_point_id}"
    headers = {
        "Authorization": "Bearer " + ACCESS_TOKEN
    }

    # Update Data Example
    data = {
        "name": "my_updated_service_point",
        "type": "d666a904-5739-46c0-b70a-1cd57658a3f6",
        "status": "e5e41ad2-1c46-4c3b-91cb-4cf1a82ac120",
        "latitude": 30.54321,
        "longitude": -12.5432,
        "dynamic_field_list": json.dumps([
            {
                "key": "numberField",
                "value": 456
            }
        ]),
        "order_settings": json.dumps([
            {
                "order_type": "07b31501-70f9-4d4c-8eb7-3b013ebe8d62",
                "order_items": ["573806b5-f054-48a2-8043-c75a83be871e"]
            }
        ]),
        "entities": json.dumps(["009f40a6-1dd5-4380-97b5-8b0d406ee45a"]),
        "ops_service_point_id": 12345,
        "ops_service_point_name": "my_ops_service_point_updated",
        "attachments_tbd": json.dumps(["old_file.png"]),
        "address": "123 Example St, Example City"
    }

    # File Data Example
    files = {
        "attachments": ("<file_name>", open("<file_name>", "rb"), "<file_type>")
    }

    resp = requests.patch(EVREKA360_API_BASE_URL + service_url, headers=headers, data=data, files=files)
    print(resp.status_code, resp.json())


Response
^^^^^^^^^^^^^^^^^
*Status Code:* ``200`` - Retrieved successfully

*Content Type:* ``application/json``

*Body:*

.. code-block:: json 

    {
        "detail": "Successfully updated Service Point ({service_point.name})"
    }

*Status Code:* ``404`` - Not Found
*Content Type:* ``application/json``
*Body:*


.. code-block:: json

    {
        "detail": "Service Point ({service_point_id}) not found"
    }

